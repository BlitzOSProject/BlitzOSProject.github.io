<html xmlns:o="urn:schemas-microsoft-com:office:office"xmlns:w="urn:schemas-microsoft-com:office:word"xmlns="http://www.w3.org/TR/REC-html40"><head><meta name=Title content="Assembler Example"><meta name=Keywords content=""><meta http-equiv=Content-Type content="text/html; charset=macintosh"><meta name=ProgId content=Word.Document><meta name=Generator content="Microsoft Word 11"><meta name=Originator content="Microsoft Word 11"><link rel=File-List href="ExamplePgm_files/filelist.xml"><title>Assembler Example</title><!--[if gte mso 9]><xml> <o:DocumentProperties>  <o:Author>Harry H. Porter III</o:Author>  <o:Template>Normal</o:Template>  <o:LastAuthor>Harry Porter</o:LastAuthor>  <o:Revision>2</o:Revision>  <o:LastPrinted>2007-09-19T00:16:00Z</o:LastPrinted>  <o:Created>2007-09-19T00:16:00Z</o:Created>  <o:LastSaved>2007-09-19T00:16:00Z</o:LastSaved>  <o:Pages>3</o:Pages>  <o:Words>2442</o:Words>  <o:Characters>13922</o:Characters>  <o:Lines>116</o:Lines>  <o:Paragraphs>27</o:Paragraphs>  <o:CharactersWithSpaces>17097</o:CharactersWithSpaces>  <o:Version>11.773</o:Version> </o:DocumentProperties> <o:OfficeDocumentSettings>  <o:AllowPNG/> </o:OfficeDocumentSettings></xml><![endif]--><!--[if gte mso 9]><xml> <w:WordDocument>  <w:DisplayHorizontalDrawingGridEvery>0</w:DisplayHorizontalDrawingGridEvery>  <w:DisplayVerticalDrawingGridEvery>0</w:DisplayVerticalDrawingGridEvery>  <w:UseMarginsForDrawingGridOrigin/> </w:WordDocument></xml><![endif]--><style><!-- /* Font Definitions */@font-face	{font-family:"Times New Roman";	panose-1:0 2 2 6 3 5 4 5 2 3;	mso-font-charset:0;	mso-generic-font-family:auto;	mso-font-pitch:variable;	mso-font-signature:50331648 0 0 0 1 0;} /* Style Definitions */p.MsoNormal, li.MsoNormal, div.MsoNormal	{mso-style-parent:"";	margin:0in;	margin-bottom:.0001pt;	mso-pagination:widow-orphan;	font-size:12.0pt;	font-family:Times;}h1	{mso-style-next:Normal;	margin:0in;	margin-bottom:.0001pt;	text-align:center;	mso-pagination:widow-orphan;	page-break-after:avoid;	mso-outline-level:1;	font-size:24.0pt;	font-family:Times;	mso-font-kerning:0pt;}p.MsoToc1, li.MsoToc1, div.MsoToc1	{mso-style-update:auto;	mso-style-next:Normal;	margin:0in;	margin-bottom:.0001pt;	mso-pagination:widow-orphan;	font-size:12.0pt;	font-family:Times;	font-weight:bold;}p.MsoHeader, li.MsoHeader, div.MsoHeader	{margin:0in;	margin-bottom:.0001pt;	mso-pagination:widow-orphan;	tab-stops:center 3.0in right 6.0in;	font-size:12.0pt;	font-family:Times;}p.MsoFooter, li.MsoFooter, div.MsoFooter	{margin:0in;	margin-bottom:.0001pt;	mso-pagination:widow-orphan;	tab-stops:center 3.0in right 6.0in;	font-size:12.0pt;	font-family:Times;}table.MsoNormalTable	{mso-style-parent:"";	font-size:10.0pt;	font-family:Times;}p.Code, li.Code, div.Code	{mso-style-name:Code;	margin:0in;	margin-bottom:.0001pt;	text-indent:.75in;	mso-pagination:widow-orphan;	font-size:10.0pt;	font-family:Courier;}@page Section1	{size:8.5in 11.0in;	margin:.5in .75in .5in .75in;	mso-header-margin:.5in;	mso-footer-margin:.5in;	mso-title-page:yes;	mso-header:url(":ExamplePgm_files:header.htm") h1;	mso-footer:url(":ExamplePgm_files:header.htm") f1;	mso-first-footer:url(":ExamplePgm_files:header.htm") ff1;	mso-paper-source:0;}div.Section1	{page:Section1;}--></style></head><body bgcolor=white lang=EN-US style='tab-interval:.5in'><div class=Section1><p class=MsoNormal><span style='font-size:10.0pt;font-family:Courier'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p><h1><u>Example BLITZ Assembly Program<o:p></o:p></u></h1><p class=MsoNormal><span style='font-size:10.0pt;font-family:Courier'><b><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></b></span></p><p class=MsoNormal><span style='font-size:10.0pt;font-family:Courier'><b><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></b></span></p><p class=MsoNormal><span style='font-size:10.0pt;font-family:Courier'><b><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></b></span></p><p class=MsoNormal><span style='font-size:10.0pt;font-family:Courier'><b><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></b></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'>!Example.s<span style="mso-spacerun: yes">&nbsp; </span>--<spanstyle="mso-spacerun: yes">&nbsp; </span>Serial I/O Interface Routines<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'>!<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'>! HarryPorter<span style="mso-spacerun: yes">&nbsp; </span>-<span style="mso-spacerun:yes">&nbsp; </span>08/01/01<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'>!<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'>! Thisprogram serves as an example of BLITZ assembly code and<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'>! of therecommended style for indenting and commenting assembly code.<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'>!<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'>! Thisprogram provides a &quot;main&quot; function which reads input characters<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'>! from theterminal and echoes them back.<span style="mso-spacerun: yes">&nbsp; </span>Itcan be used to explore<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'>! thedifferences between &quot;raw&quot; and &quot;cooked&quot; serial input modes.<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'>!<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'>! Inaddition to the &quot;main&quot; function, this program also provides the<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'>!following interface for the serial I/O device; these routines might<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'>! providethe starting point for some other program.<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'>!<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'><spanstyle="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>.export getChar<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'><spanstyle="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>.export putChar<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'><spanstyle="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>.export putString<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'><spanstyle="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>.export flush<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'><spanstyle="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>.export initSerial<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'><spanstyle="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>.export checkSerialDevice<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'>!<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'>! Programentry point<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'>!<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'><spanstyle="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>.text<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'>_entry:<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'>!<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'>! Here isthe interrupt vector, which will be loaded at address 0x00000000.<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'>! Eachentry is 4 bytes.<span style="mso-spacerun: yes">&nbsp; </span>They are locatedat fixed, pre-defined addresses.<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'>! This programwill only handle SERIAL_INTERRUPTS.<span style="mso-spacerun: yes">&nbsp;</span>The asynchronous,<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'>! hardwareinterrupts (i.e., TIMER and DISK) will be ignored by returning<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'>!immediately.<span style="mso-spacerun: yes">&nbsp; </span>None of the otherinterrupts should occur; if they do, this<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'>! programwill get stuck in an infinite loop. <o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'>!<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'>PowerOnReset:<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'><spanstyle="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>jmp<span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp; </span>main<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'>TimerInterrupt:<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'><spanstyle="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>reti<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'>DiskInterrupt:<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'><spanstyle="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>reti<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'>SerialInterrupt:<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'><spanstyle="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>jmp<span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;</span>SerialInterruptHandler<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'>HardwareFault:<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'><spanstyle="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>jmp<span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;</span>HardwareFault<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'>IllegalInstruction:<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'><spanstyle="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>jmp<span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;</span>IllegalInstruction<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'>ArithmeticException:<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'><spanstyle="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>jmp<span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;</span>ArithmeticException<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'>AddressException:<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'><spanstyle="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>jmp<span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;</span>AddressException<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'>PageInvalidException:<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'><spanstyle="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>jmp<span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;</span>PageInvalidException<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'>PageReadonlyException:<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'><spanstyle="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>jmp<span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;</span>PageReadonlyException<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'>PrivilegedInstruction:<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'><spanstyle="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>jmp<spanstyle="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp; </span>PrivilegedInstruction<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'>AlignmentException:<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'><spanstyle="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>jmp<span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;</span>AlignmentException<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'>ExceptionDuringInterrupt:<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'><spanstyle="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>jmp<span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;</span>ExceptionDuringInterrupt<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'>SyscallTrap:<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'><spanstyle="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>jmp<span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;</span>SyscallTrap<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'>!<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'>!Interrupt Service routines<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'>!<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'>SerialInterruptHandler:<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'><spanstyle="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp; </span><spanstyle="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;</span>call<spanstyle="mso-spacerun: yes">&nbsp;&nbsp;&nbsp; </span>checkSerialDevice<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'><spanstyle="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>reti<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'>!<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'>! main<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'>!<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'>! The mainprogram repeatedly prints a prompt, then gets and echoes characters<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'>! until aNEWLINE is entered.<span style="mso-spacerun: yes">&nbsp; </span>It thenrepeats the prompt.<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'>!<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'>main:<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'><spanstyle="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>set<span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;</span>STACK_START,r15<span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>! initialize thestack pointer<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'><spanstyle="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>call<span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;</span>initSerial<span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>! initialize the serial I/O device<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'><spanstyle="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>seti<span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>! enable interrupts<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'>loop1:<spanstyle="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>! loop<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'><spanstyle="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>set<span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;</span>prompt,r1<span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>!<span style="mso-spacerun: yes">&nbsp;&nbsp; </span>putString (&quot;Entersomething: &quot;)<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'><spanstyle="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>call<span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;</span>putString<span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>!<span style="mso-spacerun: yes">&nbsp;&nbsp; </span>.<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'>loop2:<spanstyle="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>!<span style="mso-spacerun: yes">&nbsp;&nbsp; </span>loop<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'><spanstyle="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>call<span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;</span>getChar<span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>!<span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp; </span>r1 :=getChar<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'><spanstyle="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>cmp<span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;</span>r1,'\n'<span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>!<span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp; </span>if (r1== '\n' or '\r') then<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'><spanstyle="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><spanstyle="mso-spacerun: yes">&nbsp;</span>be<span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>then<span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>!<span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp; </span>.<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'><spanstyle="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>cmp<span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;</span>r1,'\r'<span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>!<span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp; </span>.<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'><spanstyle="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>bne<span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;</span>else<span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>!<span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp; </span>.<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'>then:<spanstyle="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>!<span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp; </span>.<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'><spanstyle="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>mov<span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;</span>'\r',r1<span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>!<span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>putChar ('\r')<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'><spanstyle="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>call<spanstyle="mso-spacerun: yes">&nbsp;&nbsp;&nbsp; </span>putChar<spanstyle="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>!<span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>.<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'><spanstyle="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>mov<span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;</span>'\n',r1<span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>!<span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>putChar ('\n')<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'><spanstyle="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>call<span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;</span>putChar<span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>!<span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>.<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'><spanstyle="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>jmp<span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;</span>exit<span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>!<span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>break<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'>else:<spanstyle="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>!<span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp; </span>else<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'><spanstyle="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>cmp<span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;</span>r1,'q'<span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>!<span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>if (r1 == 'q') then<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'><spanstyle="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>bne<span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;</span>else2<span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>!<span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>.<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'><spanstyle="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>set<span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;</span>bye,r1<span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>!<span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>print &quot;Goodbye&quot;<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'><spanstyle="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>call<span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;</span>putString<span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>!<span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>.<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'><spanstyle="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>call<span style="mso-spacerun: yes">&nbsp;&nbsp; </span><spanstyle="mso-spacerun: yes">&nbsp;</span>flush<span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>!<span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>wait until I/O completes<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'><spanstyle="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>debug<span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>!<span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>Invoke DEBUGinstruction<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'><spanstyle="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>jmp<span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;</span>cont<span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>!<span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>else<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'>else2:<spanstyle="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>!<span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>.<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'><spanstyle="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>call<span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp; </span>putChar<spanstyle="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>!<span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>putChar (r1)<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'>cont:<spanstyle="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>!<span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>end<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'><spanstyle="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>jmp<span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;</span>loop2<span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>!<span style="mso-spacerun: yes">&nbsp;&nbsp; </span>end<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'>exit:<spanstyle="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>!<span style="mso-spacerun: yes">&nbsp;&nbsp; </span>.<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'><spanstyle="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>jmp<span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;</span>loop1<span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>! end<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'>prompt:.ascii<span style="mso-spacerun: yes">&nbsp; </span>&quot;Enter something (or'q' to terminate): \n\r\0&quot;<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'>bye:<spanstyle="mso-spacerun: yes">&nbsp;&nbsp;&nbsp; </span>.ascii<spanstyle="mso-spacerun: yes">&nbsp; </span>&quot;\n\rAbout to execute DEBUGinstruction (type 'go' to resume)...<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'>\n\r\0&quot;<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'><spanstyle="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>.align<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'>!<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'>! getChar<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'>!<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'>! Thisroutine reads one character from the terminal and returns it in r1.<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'>! It doesnot echo the character or process special characters in any way.<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'>! Itchecks the input buffer and gets a character from there if one is<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'>!available.<span style="mso-spacerun: yes">&nbsp; </span>Otherwise, it waits fora key to be typed.<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'>!<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'>! r1 = thecharacter<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'>! r2 =addr of inBufferCount<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'>! r3 =inBufferCount<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'>! r4 =addr of inBufferOut<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'>! r5 =inBufferOut<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'>!<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'>!Registers modified: r1<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'>!<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'>getChar:<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'><spanstyle="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>push<span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp; </span>r2<spanstyle="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>! save registers<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'><spanstyle="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>push<span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp; </span>r3<spanstyle="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>! .<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'><spanstyle="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>push<span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp; </span>r4<spanstyle="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>! .<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'><spanstyle="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>push<span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp; </span>r5<spanstyle="mso-spacerun: yes">&nbsp;&nbsp;&nbsp; </span><span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>!.<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'><spanstyle="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>set<span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;</span>inBufferCount,r2<span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>! initialize addressregisters<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'><spanstyle="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>set<span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;</span>inBufferOut,r4<span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>! .<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'>getChLoop:<spanstyle="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>! loop<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'><spanstyle="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>!<span style="mso-spacerun: yes">&nbsp;&nbsp; </span>loop<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'><spanstyle="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>cleari<span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><spanstyle="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>!<spanstyle="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp; </span>disable interrupts<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'><spanstyle="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>load<span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;</span>[r2],r3<span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>!<span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp; </span>if(inBufferCount != 0)<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'><spanstyle="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>cmp<span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;</span>r3,0<span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>!<span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp; </span>.<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'><spanstyle="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>bne<span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;</span>getChExit<span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>!<span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>then break<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'><spanstyle="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>seti<span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;</span>!<spanstyle="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp; </span>enable interrupts<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'><spanstyle="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>jmp<span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;</span>getChLoop<span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>!<span style="mso-spacerun: yes">&nbsp;&nbsp; </span>end<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'>getChExit:<spanstyle="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>!<span style="mso-spacerun: yes">&nbsp;&nbsp; </span>.<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'><spanstyle="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>sub<span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;</span>r3,1,r3<span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>!<span style="mso-spacerun: yes">&nbsp;&nbsp; </span>inBufferCount --<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'><spanstyle="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>store<span style="mso-spacerun: yes">&nbsp;&nbsp; </span>r3,[r2]<spanstyle="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>!<span style="mso-spacerun: yes">&nbsp;&nbsp; </span>.<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'><spanstyle="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>load<span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;</span>[r4],r5<span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp; </span><spanstyle="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>!<spanstyle="mso-spacerun: yes">&nbsp;&nbsp; </span>r1 := *inBufferOut<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'><spanstyle="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>loadb<span style="mso-spacerun: yes">&nbsp;&nbsp; </span>[r5],r1<spanstyle="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>!<span style="mso-spacerun: yes">&nbsp;&nbsp; </span>.<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'><spanstyle="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>add<span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;</span>r5,1,r5<span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>!<span style="mso-spacerun: yes">&nbsp;&nbsp; </span>inBufferOut ++<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'><spanstyle="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>cmp<span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;</span>r5,inBufferEnd<span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>!<spanstyle="mso-spacerun: yes">&nbsp;&nbsp; </span>if (inBufferOut == inBufferEnd)<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'><spanstyle="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>bne<span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;</span>getChElse<span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>!<span style="mso-spacerun: yes">&nbsp;&nbsp; </span>.<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'><spanstyle="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>set<span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;</span>inBuffer,r5<span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>!<span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;</span>inBufferOut := &amp;inBuffer<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'>getChElse:<spanstyle="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>!<span style="mso-spacerun: yes">&nbsp;&nbsp; </span>end<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'><spanstyle="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>store<span style="mso-spacerun: yes">&nbsp;&nbsp; </span>r5,[r4]<spanstyle="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>!<span style="mso-spacerun: yes">&nbsp;&nbsp; </span>save inBufferOut<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'><spanstyle="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>seti<span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>!<span style="mso-spacerun: yes">&nbsp;&nbsp; </span>enable interrupts<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'><spanstyle="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>cmp<spanstyle="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp; </span>r1,'\0'<spanstyle="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>! until (r1 != '\0')<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'><spanstyle="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>be<span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>getChLoop<span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>! .<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'><spanstyle="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>pop<span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;</span>r5<span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>! restore regs<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'><spanstyle="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>pop<span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;</span>r4<span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>! .<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'><spanstyle="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>pop<span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;</span>r3<span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>! .<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'><spanstyle="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>pop<span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp; </span>r2<spanstyle="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>! .<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'><spanstyle="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>ret<span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>! return<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'>!<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'>! putChar<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'>!<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'>! Thisroutine is passed a character in r1.<span style="mso-spacerun: yes">&nbsp;</span>It writes it to the terminal<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'>! exactlyas it is.<span style="mso-spacerun: yes">&nbsp; </span>Normally, the outputcharacter is added to a buffer<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'>! and willbe written as soon as the device is ready.<span style="mso-spacerun:yes">&nbsp; </span>If the buffer is<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'>! full,this routine will busy-wait for the buffer to become not-full.<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'>!<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'>! r1 = thecharacter<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'>! r2 =addr of outBufferCount<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'>! r3 =outBufferCount<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'>! r4 =addr of outBufferIn<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'>! r5 =outBufferIn<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'>!<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'>! Registersmodified: none<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'>!<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'>putChar:<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'><spanstyle="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>push<span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp; </span>r2<spanstyle="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>! save registers<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'><spanstyle="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>push<span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp; </span>r3<spanstyle="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>! .<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'><spanstyle="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>push<span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp; </span>r4<spanstyle="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>! .<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'><spanstyle="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>push<span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp; </span>r5<spanstyle="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>! .<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'><spanstyle="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>set<span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;</span>outBufferCount,r2 <span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>! initialize address registers<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'><spanstyle="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>set<span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;</span>outBufferIn,r4<span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>! .<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'>putChLoop:<spanstyle="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>! loop<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'><spanstyle="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>cleari<span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>!<span style="mso-spacerun: yes">&nbsp;&nbsp; </span>disable interrupts<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'><spanstyle="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>load<span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;</span>[r2],r3<span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>!<span style="mso-spacerun: yes">&nbsp;&nbsp; </span>if (outBufferCount&lt; BUFFER_SIZE)<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'><spanstyle="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>cmp<span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;</span>r3,BUFFER_SIZE<span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>!<spanstyle="mso-spacerun: yes">&nbsp;&nbsp; </span>.<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'><spanstyle="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>bl<span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>putChExit<span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>!<span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp; </span>thenbreak<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'><spanstyle="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>seti<span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>!<span style="mso-spacerun: yes">&nbsp;&nbsp; </span>enable interrupts<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'><spanstyle="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>jmp<span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;</span>putChLoop<span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>! end<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'>putChExit:<spanstyle="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>! .<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'><spanstyle="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>add<span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;</span>r3,1,r3<span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>! outBufferCount ++<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'><spanstyle="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>store<span style="mso-spacerun: yes">&nbsp;&nbsp; </span>r3,[r2]<spanstyle="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>! .<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'><spanstyle="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>load<span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;</span>[r4],r5<span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>! *outBufferIn := r1<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'><spanstyle="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>storeb<span style="mso-spacerun: yes">&nbsp; </span>r1,[r5]<spanstyle="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>! .<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'><spanstyle="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>add<span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;</span>r5,1,r5<span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><spanstyle="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>! outBufferIn ++<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'><spanstyle="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>cmp<span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;</span>r5,outBufferEnd<span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>! if (outBufferIn== outBufferEnd) then<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'><spanstyle="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>bne<span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;</span>putChElse<span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>! .<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'><spanstyle="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>set<span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;</span>outBuffer,r5<span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>!<span style="mso-spacerun: yes">&nbsp;&nbsp; </span>outBufferIn :=&amp;outBuffer<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'>putChElse:<spanstyle="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>! end<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'><spanstyle="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>store<span style="mso-spacerun: yes">&nbsp;&nbsp; </span>r5,[r4]<spanstyle="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>! save outBufferIn<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'><spanstyle="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>call<span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;</span>checkSerialDevice<span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>! start output if necessary<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'><spanstyle="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>seti<span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>! enable interrupts<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'><spanstyle="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>pop<span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;</span>r5<span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>! restore regs<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'><spanstyle="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>pop<spanstyle="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp; </span>r4<spanstyle="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>! .<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'><spanstyle="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>pop<span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;</span>r3<span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>! .<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'><spanstyle="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>pop<span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;</span>r2<span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>! .<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'><spanstyle="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>ret<span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>! return<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'>!<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'>!putString<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'>!<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'>! Thisroutine is passed a pointer to a string of characters, terminated<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'>! by'\0'.<span style="mso-spacerun: yes">&nbsp; </span>It sends all of them exceptthe final '\0' to the terminal by<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'>! calling'putChar' repeatedly.<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'>!<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'>!Registers modified: none<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'>!<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'>putString:<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'><spanstyle="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>push<span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp; </span>r1<spanstyle="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>! save registers<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'><spanstyle="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>push<span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp; </span>r2<spanstyle="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>! .<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'><spanstyle="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>mov<span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;</span>r1,r2<span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>! r2 := ptr into string<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'>putStLoop:<spanstyle="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>! loop<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'><spanstyle="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>loadb<span style="mso-spacerun: yes">&nbsp;&nbsp; </span>[r2],r1<spanstyle="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>!<span style="mso-spacerun: yes">&nbsp;&nbsp; </span>r1 := next char<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'><spanstyle="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>add<span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;</span>r2,1,r2<span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>!<span style="mso-spacerun: yes">&nbsp;&nbsp; </span>incr ptr<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'><spanstyle="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>cmp<span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;</span>r1,0<span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><spanstyle="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>!<spanstyle="mso-spacerun: yes">&nbsp;&nbsp; </span>if (r1 == '\0')<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'><spanstyle="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>be<span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>putStExit<span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>!<span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp; </span>thenbreak<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'><spanstyle="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>call<span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;</span>putChar<span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>!<span style="mso-spacerun: yes">&nbsp;&nbsp; </span>putChar (r1)<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'><spanstyle="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>jmp<span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;</span>putStLoop<span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>! end<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'>putStExit:<spanstyle="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>! .<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'><spanstyle="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>pop<span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;</span>r2<span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp; </span><spanstyle="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>!restore regs<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'><spanstyle="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>pop<span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;</span>r1<span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>! .<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'><spanstyle="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>ret<span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>! return<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'>!<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'>! flush<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'>!<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'>! Thisroutine waits until the output buffer has been emptied, then returns.<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'>! Itbusy-waits until the buffer has been emptied.<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'>!<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'>!Registers modified: none<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'>!<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'>flush:<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'><spanstyle="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>push<span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp; </span>r1<spanstyle="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>! save registers<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'><spanstyle="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>push<span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp; </span>r2<spanstyle="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>! .<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'>flushLoop:<spanstyle="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>! loop<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'><spanstyle="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>cleari<span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>!<span style="mso-spacerun: yes">&nbsp;&nbsp; </span>disable interrupts<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'><spanstyle="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>set<span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;</span>outBufferCount,r1<span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>!<span style="mso-spacerun:yes">&nbsp;&nbsp; </span>r2 = outBufferCount<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'><spanstyle="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>load<span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;</span>[r1],r2<span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>!<span style="mso-spacerun: yes">&nbsp;&nbsp; </span>.<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'><spanstyle="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>cmp<span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;</span>r2,0<span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>!<span style="mso-spacerun: yes">&nbsp;&nbsp; </span>if (r2 == 0)<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'><spanstyle="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>be<span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>flushLoopEx<span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>!<span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp; </span>break<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'><spanstyle="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>seti<span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>!<spanstyle="mso-spacerun: yes">&nbsp;&nbsp; </span>re-enable interrupts<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'><spanstyle="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>jmp<span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;</span>flushLoop<span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>! end<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'>flushLoopEx:<spanstyle="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>! .<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'><spanstyle="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>seti<span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>! re-enable interrupts<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'><spanstyle="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>pop<span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;</span>r2<span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>! restore regs<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'><spanstyle="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>pop<span style="mso-spacerun: yes">&nbsp;&nbsp; </span><spanstyle="mso-spacerun: yes">&nbsp;&nbsp;</span>r1<span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>! .<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'><spanstyle="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>ret<span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>! return<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'>!<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'>!initSerial<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'>!<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'>! Thisroutine initializes the serial input and output buffers.<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'>!<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'>!Registers modified: r1, r2<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'>!<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'>initSerial:<spanstyle="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp; </span>set<spanstyle="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp; </span>inBuffer,r1<spanstyle="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>! inBuferIn = &amp;inBuffer<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'><spanstyle="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>set<span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;</span>inBufferIn,r2<span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>! .<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'><spanstyle="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>store<span style="mso-spacerun: yes">&nbsp;&nbsp; </span>r1,[r2]<spanstyle="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>! .<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'><spanstyle="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>set<span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;</span>inBufferOut,r2<span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>! inBufferOut = &amp;inBuffer<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'><spanstyle="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>store<span style="mso-spacerun: yes">&nbsp;&nbsp; </span>r1,[r2]<spanstyle="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>! .<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'><spanstyle="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="mso-spacerun: yes">&nbsp;&nbsp;</span>set<spanstyle="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp; </span>outBuffer,r1<spanstyle="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>! outBufferIn = &amp;outBuffer<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'><spanstyle="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>set<span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;</span>outBufferIn,r2<span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>! .<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'><spanstyle="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>store<span style="mso-spacerun: yes">&nbsp;&nbsp; </span>r1,[r2]<spanstyle="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>! .<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'><spanstyle="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>set<span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;</span>outBufferOut,r2<span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>! outBufferOut = &amp;outBuffer<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'><spanstyle="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="mso-spacerun: yes">&nbsp;</span>store<spanstyle="mso-spacerun: yes">&nbsp;&nbsp; </span>r1,[r2]<span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>! .<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'><spanstyle="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>clr<span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;</span>r1<span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>! inBufferCount = 0<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'><spanstyle="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>set<span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;</span>inBufferCount,r2<span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>! .<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'><spanstyle="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>store<span style="mso-spacerun: yes">&nbsp;&nbsp; </span>r1,[r2]<spanstyle="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>! .<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'><spanstyle="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>set<span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;</span>outBufferCount,r2<span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="mso-spacerun: yes">&nbsp;</span>! outBufferCount = 0<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'><spanstyle="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>store<span style="mso-spacerun: yes">&nbsp;&nbsp; </span>r1,[r2]<spanstyle="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>! .<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'><spanstyle="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>ret<span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>! return<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'>!<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'>!checkSerialDevice<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'>!<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'>! Thisroutine is called whenever there is a SerialInterrupt.<spanstyle="mso-spacerun: yes">&nbsp; </span>If a character<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'>! is readyon the input, it is moved into the inBuffer.<span style="mso-spacerun:yes">&nbsp; </span>If there is no<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'>! moreroom in the buffer, the character is simply dropped, with no<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'>! errorindication.<span style="mso-spacerun: yes">&nbsp; </span>If the output deviceis ready to for another character<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'>! andthere are any characters in the outBuffer, then the next character is<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'>!transmitted to the output device.<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'>!<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'>! Noarguments, no result.<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'>! Thisroutine must be called with interrupts disabled!<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'>!Registers modified: none<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'>!<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'>! r8 =addr of SERIAL_STATUS_WORD<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'>! r1 =SERIAL_STATUS_WORD<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'>! r11 =addr of SERIAL_DATA_WORD<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'>! r2 = thecharacter<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'>! r9 =addr of inBufferCount<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'>! r5 =inBufferCount<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'>! r10 =addr of inBufferIn<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'>! r3 =inBufferIn<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'>! r7 =addr of outBufferOut<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'>! r4 =outBufferOut<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'>! r6 =addr of outBufferCount<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'>! r5 =outBufferCount<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'>!<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'>checkSerialDevice:<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'><spanstyle="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>push<span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp; </span>r1<spanstyle="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>! save all registers we use<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'><spanstyle="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>push<span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp; </span>r2<spanstyle="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>! .<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'><spanstyle="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>push<span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp; </span>r3<spanstyle="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>! .<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'><spanstyle="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>push<span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp; </span>r4<spanstyle="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>! .<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'><spanstyle="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>push<span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp; </span>r5<spanstyle="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>! .<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'><spanstyle="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>push<span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp; </span>r6<spanstyle="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><spanstyle="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>!.<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'><spanstyle="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>push<span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp; </span>r7<spanstyle="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>! .<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'><spanstyle="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>push<span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp; </span>r8<spanstyle="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>! .<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'><spanstyle="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>push<span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp; </span>r9<spanstyle="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>! .<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'><spanstyle="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>push<span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp; </span>r10<spanstyle="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>! .<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'><spanstyle="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>push<span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp; </span>r11<spanstyle="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>! .<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'><spanstyle="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>set<span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp; </span>SERIAL_DATA,r11<spanstyle="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>! r11 = addr of SERIAL_DATA_WORD<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'><spanstyle="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>set<span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;</span>SERIAL_STAT,r8<span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>! r1 :=serial status word<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'><spanstyle="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>load<span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;</span>[r8],r1<span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>! .<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'><spanstyle="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>btst<span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;</span>0x00000001,r1<span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>! ifstatus[charAvail] == 1 then<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'><spanstyle="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>be<span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>end1<span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>! .<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'><spanstyle="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>load<span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;</span>[r11],r2<span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>!<span style="mso-spacerun: yes">&nbsp;&nbsp; </span>r2 := input char<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'><spanstyle="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>set<span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;</span>inBufferCount,r9<span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>! if inBufferCount &lt;bufSize then<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'><spanstyle="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>load<span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;</span>[r9],r5<span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>!<span style="mso-spacerun: yes">&nbsp;&nbsp; </span>.<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'><spanstyle="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>cmp<span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;</span>r5,BUFFER_SIZE<span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>!<spanstyle="mso-spacerun: yes">&nbsp;&nbsp; </span>.<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'><spanstyle="mso-spacerun: yes">&nbsp;&nbsp;&nbsp; </span><span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;</span>bge<span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp; </span>end1<span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>!<span style="mso-spacerun: yes">&nbsp;&nbsp; </span>.<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'><spanstyle="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>set<span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;</span>inBufferIn,r10<span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>!<spanstyle="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp; </span>*inBufferIn := char<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'><spanstyle="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>load<span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;</span>[r10],r3<span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>!<span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp; </span>.<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'><spanstyle="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>storeb<span style="mso-spacerun: yes">&nbsp; </span>r2,[r3]<spanstyle="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>!<span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp; </span>.<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'><spanstyle="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>add<span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;</span>r5,1,r5<span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>!<span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp; </span>inBufferCount++<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'><spanstyle="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>store<span style="mso-spacerun: yes">&nbsp;&nbsp; </span>r5,[r9]<spanstyle="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>!<span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp; </span>.<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'><spanstyle="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>add<span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;</span>r3,1,r3<span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>!<span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;</span>inBufferIn++<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'><spanstyle="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>cmp<span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;</span>r3,inBufferEnd<span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>!<spanstyle="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp; </span>if inBufferIn ==inBufferEnd then<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'><spanstyle="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>bne<span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;</span>end2<span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>!<span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp; </span>.<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'><spanstyle="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>set<spanstyle="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp; </span>inBuffer,r3<spanstyle="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>!<span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>inBufferIn = &amp;inBuffer<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'>end2:<spanstyle="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>!<span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp; </span>end<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'><spanstyle="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>store<span style="mso-spacerun: yes">&nbsp;&nbsp; </span>r3,[r10]<spanstyle="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>!<span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp; </span>storeinBufferIn<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'>end1:<spanstyle="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>!<span style="mso-spacerun: yes">&nbsp;&nbsp; </span>end<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'><spanstyle="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>!end<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'><spanstyle="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>btst<span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;</span>0x00000002,r1<span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>! ifstatus[outputReady] == 1 then<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'><spanstyle="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>be<span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>end4<span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>! .<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'><spanstyle="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>set<span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;</span>outBufferCount,r6<span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>!<span style="mso-spacerun:yes">&nbsp;&nbsp; </span>if outBufferCount&gt;0 then<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'><spanstyle="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>load<span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;</span>[r6],r5<span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>!<span style="mso-spacerun: yes">&nbsp;&nbsp; </span>.<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'><spanstyle="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>cmp<spanstyle="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp; </span>r5,0<spanstyle="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>!<span style="mso-spacerun: yes">&nbsp;&nbsp; </span>.<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'><spanstyle="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>ble<span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;</span>end4<span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>!<span style="mso-spacerun: yes">&nbsp;&nbsp; </span>.<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'><spanstyle="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>set<span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;</span>outBufferOut,r7<span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>!<spanstyle="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp; </span>r2 := *outBufferOut<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'><spanstyle="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>load<span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;</span>[r7],r4<span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>!<span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp; </span>.<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'><spanstyle="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>loadb<span style="mso-spacerun: yes">&nbsp;&nbsp; </span>[r4],r2<spanstyle="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>!<span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp; </span>.<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'><spanstyle="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>store<span style="mso-spacerun: yes">&nbsp;&nbsp; </span>r2,[r11]<spanstyle="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>!<span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp; </span>sendchar in r2 to serial output<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'><spanstyle="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>sub<span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;</span>r5,1,r5<span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>!<span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;</span>outBufferCount--<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'><spanstyle="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>store<span style="mso-spacerun: yes">&nbsp;&nbsp; </span>r5,[r6]<spanstyle="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>!<span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp; </span>.<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'><spanstyle="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>add<span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;</span>r4,1,r4<span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>!<span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;</span>outBufferOut++<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'><spanstyle="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>cmp<span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp; </span>r4,outBufferEnd<spanstyle="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>!<span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp; </span>ifoutBufferOut==outBufferEnd then<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'><spanstyle="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>bne<span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;</span>end3<span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>!<span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp; </span>.<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'><spanstyle="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>set<span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;</span>outBuffer,r4<span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>!<span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>outBufferOut = &amp;outBuffer<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'>end3:<spanstyle="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>!<span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp; </span>end<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'><spanstyle="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>store<span style="mso-spacerun: yes">&nbsp;&nbsp; </span>r4,[r7]<spanstyle="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>!<span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp; </span>storeoutBufferOut<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'>end4:<spanstyle="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>!<span style="mso-spacerun: yes">&nbsp;&nbsp; </span>end<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'><spanstyle="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>! end<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'><spanstyle="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>pop<span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;</span>r11<span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>! restore all registers<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'><spanstyle="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>pop<span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;</span>r10<span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>! .<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'><spanstyle="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>pop<spanstyle="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp; </span>r9<spanstyle="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>! .<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'><spanstyle="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>pop<span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;</span>r8<span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>! .<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'><spanstyle="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>pop<span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;</span>r7<span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>! .<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'><spanstyle="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>pop<span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;</span>r6<span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>! .<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'><spanstyle="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>pop<span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;</span>r5<span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>! .<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'><spanstyle="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>pop<span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;</span>r4<span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>! .<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'><spanstyle="mso-spacerun: yes">&nbsp; </span><span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>pop<span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp; </span>r3<span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>! .<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'><spanstyle="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>pop<span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;</span>r2<span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>! .<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'><spanstyle="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>pop<span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;</span>r1<span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>! .<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'><spanstyle="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>ret<span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>! return<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'><spanstyle="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>.data<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'>BUFFER_SIZE<spanstyle="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp; </span>=<spanstyle="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>128<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'>inBuffer:<spanstyle="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>.skip<span style="mso-spacerun: yes">&nbsp;&nbsp; </span>BUFFER_SIZE<spanstyle="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp; </span>! Serial Input bufferarea<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'>inBufferEnd:<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'>inBufferIn:<spanstyle="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp; </span>.word<spanstyle="mso-spacerun: yes">&nbsp;&nbsp; </span>0<span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>! Addr of next place to add to<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'>inBufferOut:<spanstyle="mso-spacerun: yes">&nbsp;&nbsp;&nbsp; </span>.word<spanstyle="mso-spacerun: yes">&nbsp;&nbsp; </span>0<span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>! Addr of next place to remove from<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'>inBufferCount:<spanstyle="mso-spacerun: yes">&nbsp; </span>.word<span style="mso-spacerun:yes">&nbsp;&nbsp; </span>0<span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>! Number of characters in inBuffer<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'>outBuffer:<spanstyle="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>.skip<spanstyle="mso-spacerun: yes">&nbsp;&nbsp; </span>BUFFER_SIZE<spanstyle="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp; </span>! Serial Outputbuffer area<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'>outBufferEnd:<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'>outBufferIn:<spanstyle="mso-spacerun: yes">&nbsp;&nbsp;&nbsp; </span>.word<spanstyle="mso-spacerun: yes">&nbsp;&nbsp; </span>0<span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>! Addr of next place to add to<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'>outBufferOut:<spanstyle="mso-spacerun: yes">&nbsp;&nbsp; </span>.word<span style="mso-spacerun:yes">&nbsp;&nbsp; </span>0<span style="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>! Addr of next place to remove from<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'>outBufferCount:.word<span style="mso-spacerun: yes">&nbsp;&nbsp; </span>0<spanstyle="mso-spacerun:yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>! Number of characters in outBuffer<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'>STACK_START<spanstyle="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp; </span>=<spanstyle="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>0x00ffff00<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'>SERIAL_STAT<spanstyle="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp; </span>=<spanstyle="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>0x00ffff00<span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>! Addr of SERIAL_STATUS_WORD<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'>SERIAL_DATA<spanstyle="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp; </span>=<spanstyle="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>0x00ffff04<span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>! Addr of SERIAL_DATA_WORD<o:p></o:p></span></p><p class=MsoNormal><span style='font-size:9.0pt;font-family:Courier'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p></div></body></html>